{% extends 'auction/base.html' %}
{% load static %}
{% load crispy_forms_tags %}
{% load tz %}
{% block content %}

<main class="main">

    <!-- Page Title -->
    <div class="page-title">
        <div class="heading">
            <div class="container">
                <div class="row d-flex justify-content-center text-center">
                    <div class="col-lg-8">
                        <h1 class="heading-title">Your Cart</h1>
                        <p class="mb-0">
                            Hello, {{ request.user.first_name }}, review the items in your cart below.
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <nav class="breadcrumbs">
            <div class="container">
                <ol>
                    <li><a href="{% url 'home' %}">Home</a></li>
                    <li class="current">Your Cart</li>
                </ol>
            </div>
        </nav>
    </div><!-- End Page Title -->

    <!-- Starter Section Section -->
    <section id="starter-section" class="starter-section section">

        <!-- Section Title -->
        <!-- <div class="container section-title" data-aos="fade-up">
            <h2>Your Cart</h2>
            <p>Review the items in your cart below:</p>
        </div> -->

        <div class="container" data-aos="fade-up">
            {% if slots %}
            <table class="table">
                <thead>
                    <tr>
                        <th>Course</th>
                        <th>Time</th>
                        <th>Price</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for slot in slots %}
                    <tr>
                        <td>{{ slot.course.title }}</td>
                        <td>{{ slot.start_time|time:"H:i" }}</td>
                        <td>${{ slot.course.price|floatformat:2 }}</td>
                        <td>
                            <form method="post" action="{% url 'courses:remove_from_cart' slot.id %}">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-danger btn-sm">
                                    Remove
                                </button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

            <h4>Total: ${{ total_amount|floatformat:2 }}</h4>

            <form method="post" action="{% url 'courses:cart_checkout' %}">
                {% csrf_token %}
                <button type="submit" class="btn btn-success">
                    Checkout
                </button>
            </form>
            {% else %}
            <p>Your cart is empty.</p>
            {% endif %}
            <br>
            <p><a class="btn btn-info" href="{% url 'courses:course_list' %}">Book more courses</a></p>
        </div>



    </section><!-- /Starter Section Section -->

</main>

{% endblock %}